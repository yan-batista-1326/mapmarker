{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\Yan\\\\Desktop\\\\App\\\\mapmarker\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Yan\\\\Desktop\\\\App\\\\mapmarker\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\Yan\\\\Desktop\\\\App\\\\mapmarker\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\Yan\\\\Desktop\\\\App\\\\mapmarker\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Konva from'konva';import'./styles.css';import MarkerIcon from'../../icon/marker.png';var stage=null;var imageLayer=null;var textLayer=null;var markerLayer=null;var Sidebar=/*#__PURE__*/function(_Component){_inherits(Sidebar,_Component);var _super=_createSuper(Sidebar);function Sidebar(){_classCallCheck(this,Sidebar);return _super.apply(this,arguments);}_createClass(Sidebar,[{key:\"componentDidMount\",value:function componentDidMount(){Sidebar.initialize();}},{key:\"addPhoto\",value:function addPhoto(){var reader=new FileReader();var file=document.getElementById('addPhoto').files[0];reader.onload=function(e){var result=e.target.result;var mapObj=new Image();mapObj.src=result;mapObj.onload=function(){var mapKonva=new Konva.Image({image:mapObj,width:720,height:720,offsetX:720/2,offsetY:720/2,x:stage.width()/2,y:stage.height()/2});//Check if there is an image\nif(imageLayer.find('Image').length>0){Sidebar.removeAll();Sidebar.initialize();}imageLayer.add(mapKonva);imageLayer.batchDraw();stage.add(imageLayer);};};reader.readAsDataURL(file);}},{key:\"addMarker\",value:function addMarker(){if(imageLayer.find('Image').length>0){//If there is an image\nvar markerObj=new Image();markerObj.src=MarkerIcon;markerObj.onload=function(){var markerKonva=new Konva.Image({image:markerObj,width:50,height:50,draggable:true,x:stage.width()/2,y:stage.height()/2});markerLayer.add(markerKonva);markerLayer.batchDraw();markerKonva.on('dragend',function(){//Check if the element is out of bounds and delete it if it is\nvar markerPos=markerKonva.getPosition();if(markerPos.x>stage.width()-50||markerPos.x<0||markerPos.y>stage.height()-50||markerPos.y<0){markerKonva.destroy();markerLayer.batchDraw();}});stage.add(markerLayer);};}}},{key:\"addText\",value:function addText(){if(imageLayer.find('Image').length>0){//If there is an image\n//Create Text Input\nvar textInput=document.createElement('input');textInput.type=\"text\";textInput.id=\"insertTextInput\";document.getElementById('contentCanvas').appendChild(textInput);textInput.focus();//Send text event\ntextInput.addEventListener('keypress',function(e){var konvaText=null;if(e.keyCode===13){//Check Enter\nvar textValue=textInput.value;//Create and Add Konva Text to the layer\nkonvaText=new Konva.Text({text:textValue.toUpperCase(),fontSize:20,fontFamily:'Roboto',draggable:true,x:stage.width()/2,y:stage.height()/2,fill:'black',name:'textContent'});textLayer.add(konvaText);konvaText.on('dragend',function(){//Check if the element is out of bounds and delete it if it is\nvar textPos=konvaText.getPosition();if(textPos.x>stage.width()-50||textPos.x<0||textPos.y>stage.height()-50||textPos.y<0){konvaText.destroy();textLayer.batchDraw();}});stage.add(textLayer);//Remove Input and related listeners\ndocument.removeEventListener('click',e);textInput.remove();}});//Check if there is a click outside the element, and remove it\ndocument.addEventListener('click',function(e){if(e.target!==textInput){document.removeEventListener('click',e);textInput.remove();}});//Create the transformer\nvar konvaTransformer=new Konva.Transformer();textLayer.add(konvaTransformer);//Check if user clicked on the text and select it\nstage.on('click',function(e){if(!e.target.hasName('textContent'))konvaTransformer.nodes([]);else konvaTransformer.nodes([e.target]);textLayer.batchDraw();});}}},{key:\"saveMap\",value:function saveMap(){if(imageLayer.find('Image').length>0){//Check if there is an image to be saved\nvar link=document.createElement('a');link.download='map.png';link.href=stage.toDataURL({pixelRatio:2});document.body.appendChild(link);link.click();document.body.removeChild(link);}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar\"},/*#__PURE__*/React.createElement(\"ul\",null,/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"img\",{src:\"https://img.icons8.com/metro/26/000000/cursor.png\",alt:\"cursor_icon\"})),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"img\",{src:\"https://img.icons8.com/ios/50/000000/marker.png\",alt:\"marker_icon\",onClick:this.addMarker})),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"img\",{src:\"https://img.icons8.com/material-sharp/24/000000/text.png\",alt:\"text_icon\",onClick:this.addText})),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"img\",{src:\"https://img.icons8.com/ios/50/000000/save.png\",alt:\"save_icon\",onClick:this.saveMap})),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"addPhoto\"},/*#__PURE__*/React.createElement(\"img\",{src:\"https://img.icons8.com/pastel-glyph/64/000000/plus.png\",alt:\"add_icon\"})),/*#__PURE__*/React.createElement(\"input\",{onChange:this.addPhoto,type:\"file\",name:\"photo\",id:\"addPhoto\",accept:\"image/png, image/jpeg, /image/jpg\"}))));}}],[{key:\"initialize\",value:function initialize(){//Create Stage\nstage=new Konva.Stage({container:'contentCanvas',width:1024,height:720});//Create Layers\nimageLayer=new Konva.Layer();markerLayer=new Konva.Layer();textLayer=new Konva.Layer();}},{key:\"removeAll\",value:function removeAll(){stage.remove();}}]);return Sidebar;}(Component);export{Sidebar as default};","map":{"version":3,"sources":["C:/Users/Yan/Desktop/App/mapmarker/src/components/sidebar/index.js"],"names":["React","Component","Konva","MarkerIcon","stage","imageLayer","textLayer","markerLayer","Sidebar","initialize","reader","FileReader","file","document","getElementById","files","onload","e","result","target","mapObj","Image","src","mapKonva","image","width","height","offsetX","offsetY","x","y","find","length","removeAll","add","batchDraw","readAsDataURL","markerObj","markerKonva","draggable","on","markerPos","getPosition","destroy","textInput","createElement","type","id","appendChild","focus","addEventListener","konvaText","keyCode","textValue","value","Text","text","toUpperCase","fontSize","fontFamily","fill","name","textPos","removeEventListener","remove","konvaTransformer","Transformer","hasName","nodes","link","download","href","toDataURL","pixelRatio","body","click","removeChild","addMarker","addText","saveMap","addPhoto","Stage","container","Layer"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport Konva from 'konva';\r\n\r\nimport './styles.css';\r\n\r\nimport MarkerIcon from '../../icon/marker.png';\r\n\r\nlet stage = null;\r\nlet imageLayer = null;\r\nlet textLayer = null;\r\nlet markerLayer = null;\r\n\r\nexport default class Sidebar extends Component {\r\n    componentDidMount() {\r\n        Sidebar.initialize();\r\n    }\r\n\r\n    static initialize() {\r\n        //Create Stage\r\n        stage = new Konva.Stage({\r\n            container: 'contentCanvas',\r\n            width: 1024,\r\n            height: 720\r\n        });\r\n\r\n        //Create Layers\r\n        imageLayer = new Konva.Layer();\r\n        markerLayer = new Konva.Layer();\r\n        textLayer = new Konva.Layer();\r\n    }\r\n\r\n    static removeAll() {\r\n        stage.remove();\r\n    }\r\n\r\n    addPhoto() {\r\n        const reader = new FileReader();\r\n        const file = document.getElementById('addPhoto').files[0];\r\n\r\n        reader.onload = (e) => {\r\n            const result = e.target.result;\r\n\r\n            let mapObj = new Image();\r\n            mapObj.src = result;\r\n\r\n            mapObj.onload = () => {\r\n                let mapKonva = new Konva.Image({\r\n                    image: mapObj,\r\n                    width: 720,\r\n                    height: 720,\r\n                    offsetX: 720/2,\r\n                    offsetY: 720/2,\r\n                    x: stage.width()/2,\r\n                    y: stage.height()/2\r\n                });\r\n\r\n                //Check if there is an image\r\n                if(imageLayer.find('Image').length > 0) {\r\n                    Sidebar.removeAll();\r\n                    Sidebar.initialize();\r\n                }\r\n\r\n                imageLayer.add(mapKonva);\r\n                imageLayer.batchDraw();\r\n                stage.add(imageLayer);\r\n            }\r\n        }\r\n        reader.readAsDataURL(file);\r\n    }\r\n\r\n    addMarker() {\r\n        if(imageLayer.find('Image').length > 0) { //If there is an image\r\n            let markerObj = new Image();\r\n            markerObj.src = MarkerIcon;\r\n\r\n            markerObj.onload = () => {\r\n                let markerKonva = new Konva.Image({\r\n                    image: markerObj,\r\n                    width: 50,\r\n                    height: 50,\r\n                    draggable: true,\r\n                    x: stage.width()/2,\r\n                    y: stage.height()/2\r\n                });\r\n                markerLayer.add(markerKonva);\r\n                markerLayer.batchDraw();\r\n\r\n                markerKonva.on('dragend', () => { //Check if the element is out of bounds and delete it if it is\r\n                    let markerPos = markerKonva.getPosition();\r\n                    if(markerPos.x > (stage.width() - 50) || markerPos.x < 0 || markerPos.y > (stage.height() - 50) || markerPos.y < 0) {\r\n                        markerKonva.destroy();\r\n                        markerLayer.batchDraw();\r\n                    }\r\n                });\r\n\r\n                stage.add(markerLayer);\r\n            }\r\n        }\r\n    }\r\n\r\n    addText() {\r\n        if(imageLayer.find('Image').length > 0) { //If there is an image\r\n            //Create Text Input\r\n            let textInput = document.createElement('input');\r\n            textInput.type = \"text\";\r\n            textInput.id = \"insertTextInput\";\r\n            document.getElementById('contentCanvas').appendChild(textInput);\r\n            textInput.focus();\r\n\r\n            //Send text event\r\n            textInput.addEventListener('keypress', (e) => {\r\n                let konvaText = null;\r\n                if(e.keyCode === 13) { //Check Enter\r\n                    let textValue = textInput.value;\r\n                    //Create and Add Konva Text to the layer\r\n                    konvaText = new Konva.Text({\r\n                        text: textValue.toUpperCase(),\r\n                        fontSize: 20,\r\n                        fontFamily: 'Roboto',\r\n                        draggable: true,\r\n                        x: stage.width()/2,\r\n                        y: stage.height()/2,\r\n                        fill: 'black',\r\n                        name: 'textContent'\r\n                    });\r\n                    textLayer.add(konvaText);\r\n\r\n                    konvaText.on('dragend', () => { //Check if the element is out of bounds and delete it if it is\r\n                        let textPos = konvaText.getPosition();\r\n                        if(textPos.x > (stage.width() - 50) || textPos.x < 0 || textPos.y > (stage.height() - 50) || textPos.y < 0) {\r\n                            konvaText.destroy();\r\n                            textLayer.batchDraw();\r\n                        }\r\n                    });\r\n\r\n                    stage.add(textLayer);\r\n\r\n                    //Remove Input and related listeners\r\n                    document.removeEventListener('click', (e));\r\n                    textInput.remove();\r\n                }\r\n            });\r\n\r\n            //Check if there is a click outside the element, and remove it\r\n            document.addEventListener('click', (e) => {\r\n                if(e.target !== textInput) {\r\n                    document.removeEventListener('click', (e));\r\n                    textInput.remove();\r\n                }\r\n            });\r\n\r\n            //Create the transformer\r\n            let konvaTransformer = new Konva.Transformer();\r\n            textLayer.add(konvaTransformer);\r\n\r\n            //Check if user clicked on the text and select it\r\n            stage.on('click', (e) => {\r\n                if(!e.target.hasName('textContent'))\r\n                    konvaTransformer.nodes([]);\r\n                else\r\n                    konvaTransformer.nodes([e.target]);\r\n\r\n                textLayer.batchDraw(); \r\n            });\r\n        }\r\n    }\r\n\r\n    saveMap() {\r\n        if(imageLayer.find('Image').length > 0) { //Check if there is an image to be saved\r\n            let link = document.createElement('a');\r\n            link.download = 'map.png';\r\n            link.href = stage.toDataURL({pixelRatio: 2});\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            document.body.removeChild(link);\r\n        }\r\n    }\r\n    \r\n    render() {\r\n        return(\r\n            <div className=\"sidebar\">\r\n                <ul>\r\n                    <li><img src=\"https://img.icons8.com/metro/26/000000/cursor.png\" alt=\"cursor_icon\"/></li>\r\n                    <li><img src=\"https://img.icons8.com/ios/50/000000/marker.png\" alt=\"marker_icon\" onClick={this.addMarker}/></li>\r\n                    <li><img src=\"https://img.icons8.com/material-sharp/24/000000/text.png\" alt=\"text_icon\" onClick={this.addText}/></li>\r\n                    <li><img src=\"https://img.icons8.com/ios/50/000000/save.png\" alt=\"save_icon\" onClick={this.saveMap}/></li>\r\n                    <li>\r\n                        <label htmlFor=\"addPhoto\"><img src=\"https://img.icons8.com/pastel-glyph/64/000000/plus.png\" alt=\"add_icon\"/></label>\r\n                        <input onChange={this.addPhoto} type=\"file\" name=\"photo\" id=\"addPhoto\" accept=\"image/png, image/jpeg, /image/jpg\"></input>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}